**Elicit a Zipf distribution from minimum and maximum values of distribution, and exceedance probability of maximum value**  
  
(This file is best viewed outside of Dark Mode for equation visibility)  
  
A Zipf distribution is similar in form to a Pareto distribution, in which cases are distributed with a mode at some minimum value and then dropping off immediately, in a steep exponential-like decay curve, to a tiny minority of values at many orders of magnitude larger than the mode. Unlike a Pareto distribution, the Zipf distribution is discrete, taking on only integer values. It is useful for simulating counts of events that are typically of low order-of-magnitude, but are very rarely much larger.  
  
A Zipf distribution is a zeta distribution parameterized by a single shape-parameter <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> , and also requires a minimum value. The minimum value is elicitable from a knowledge-expert, but the value of <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> is not. Therefore, we will elicit some different parameters that *are* elicitable from a knowledge-expert to define <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a>.  
  
We will define some effective maximum value, <a href="https://www.codecogs.com/eqnedit.php?latex=max\left&space;(&space;X&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?max\left&space;(&space;X&space;\right&space;)" title="max\left ( X \right )" /></a>, and an exceedance probability <a href="https://www.codecogs.com/eqnedit.php?latex=P_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P_{max}" title="P_{max}" /></a>, equivalent to the probability of an event of *greater* value than <a href="https://www.codecogs.com/eqnedit.php?latex=max\left&space;(&space;X&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?max\left&space;(&space;X&space;\right&space;)" title="max\left ( X \right )" /></a>. An analytical solution to defining <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> is unknown, but we will instead seek an empirical solution through computing Zipf
distributions across a range of <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> values and choosing the best-fit value. The criteria for a best-fit value for <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> is the value for which the resulting distribution <a href="https://www.codecogs.com/eqnedit.php?latex=Z" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Z" title="Z" /></a> expresses a probability of exceedance <a href="https://www.codecogs.com/eqnedit.php?latex=P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)" title="P\left ( X.gt.max\left ( X \right ) \right )" /></a> is closest to the elicited value for <a href="https://www.codecogs.com/eqnedit.php?latex=P_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P_{max}" title="P_{max}" /></a>. The amount of error in defining <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> depends on the resolution of the test-values for <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> that are used in the search. In the standard formulation, <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> is searched-for to the 4th decimal place. A search at higher resolution will yield less error, but will increase computation time.  
  
The search involves a test-value for <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=s_{i}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s_{i}" title="s_{i}" /></a>, and computing a Zipf distribution <a href="https://www.codecogs.com/eqnedit.php?latex=Z" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Z" title="Z" /></a> via:  
  
(1) <a href="https://www.codecogs.com/eqnedit.php?latex=Z=scipy.stats.zipf\left&space;(&space;s_{i},loc&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Z=scipy.stats.zipf\left&space;(&space;s_{i},loc&space;\right&space;)" title="Z=scipy.stats.zipf\left ( s_{i},loc \right )" /></a>, where <a href="https://www.codecogs.com/eqnedit.php?latex=loc=min\left&space;(&space;X&space;\right&space;)-1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?loc=min\left&space;(&space;X&space;\right&space;)-1" title="loc=min\left ( X \right )-1" /></a>  
  
The probability of exceedance is computed as:  
  
(2) <a href="https://www.codecogs.com/eqnedit.php?latex=P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)=1-Z.cdf\left&space;(&space;max\left&space;(&space;X&space;\right&space;)&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)=1-Z.cdf\left&space;(&space;max\left&space;(&space;X&space;\right&space;)&space;\right&space;)" title="P\left ( X.gt.max\left ( X \right ) \right )=1-Z.cdf\left ( max\left ( X \right ) \right )" /></a>  
  
The search is composed of two stages:  
  
In Stage-1, the search is taken out for values of <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> at intervals of 0.1 starting at a value very close
to 1 (<a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> must be > 1). The initial exceedance probability for the beginning value of <a href="https://www.codecogs.com/eqnedit.php?latex=s_{i}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s_{i}" title="s_{i}" /></a> is very large, and <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> is incremented by 0.1 until the exceedance probability is less than <a href="https://www.codecogs.com/eqnedit.php?latex=P_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P_{max}" title="P_{max}" /></a>. Once the exceedance probability is beneath <a href="https://www.codecogs.com/eqnedit.php?latex=P_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P_{max}" title="P_{max}" /></a>, the corresponding value of <a href="https://www.codecogs.com/eqnedit.php?latex=s_{i}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s_{i}" title="s_{i}" /></a> is taken as a ceiling for the best-fit, while the prior tested value is taken as a floor. This reduces the search-volume to a range of <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> values of only 0.1.  
  
In Stage-2, the search is taken out for all values between the floor and the ceiling at an interval of 0.0001. The value of <a href="https://www.codecogs.com/eqnedit.php?latex=s_{i}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s_{i}" title="s_{i}" /></a> which minimizes the difference between <a href="https://www.codecogs.com/eqnedit.php?latex=P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)" title="P\left ( X.gt.max\left ( X \right ) \right )" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=P_{max}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P_{max}" title="P_{max}" /></a> is taken as the solution. The error <a href="https://www.codecogs.com/eqnedit.php?latex=\varepsilon" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\varepsilon" title="\varepsilon" /></a> is computed as:  
  
(3) <a href="https://www.codecogs.com/eqnedit.php?latex=\varepsilon=\frac{\left&space;|&space;P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)-P_{max}&space;\right&space;|}{P_{max}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\varepsilon=\frac{\left&space;|&space;P\left&space;(&space;X.gt.max\left&space;(&space;X&space;\right&space;)&space;\right&space;)-P_{max}&space;\right&space;|}{P_{max}}" title="\varepsilon=\frac{\left | P\left ( X.gt.max\left ( X \right ) \right )-P_{max} \right |}{P_{max}}" /></a>  
  
The best-fit value of <a href="https://www.codecogs.com/eqnedit.php?latex=s" target="_blank"><img src="https://latex.codecogs.com/gif.latex?s" title="s" /></a> solves the system, and a Zipf distribution is computed via <a href="https://www.codecogs.com/eqnedit.php?latex=scipy.stats.zipf\left&space;(&space;s,loc&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?scipy.stats.zipf\left&space;(&space;s,loc&space;\right&space;)" title="scipy.stats.zipf\left ( s,loc \right )" /></a>, with <a href="https://www.codecogs.com/eqnedit.php?latex=loc=min\left&space;(&space;X&space;\right&space;)-1" target="_blank"><img src="https://latex.codecogs.com/gif.latex?loc=min\left&space;(&space;X&space;\right&space;)-1" title="loc=min\left ( X \right )-1" /></a>.